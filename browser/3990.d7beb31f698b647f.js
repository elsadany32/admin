"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[3990],{3990:(Ee,E,d)=>{d.r(E),d.d(E,{default:()=>ke});var e=d(5879),D=d(6814),S=d(5940),f=d(3680),Z=d(8525),B=d(4516),l=d(6223),_=d(1043),A=d(2296),O=d(617),q=d(3519),V=d.n(q),M=d(8337),y=d(8645),v=d(5619),Q=d(2664),H=d(2096),x=d(9773),p=d(2495),$=d(9388);class K{constructor(){this.expansionModel=new M.Ov(!0)}toggle(s){this.expansionModel.toggle(this._trackByValue(s))}expand(s){this.expansionModel.select(this._trackByValue(s))}collapse(s){this.expansionModel.deselect(this._trackByValue(s))}isExpanded(s){return this.expansionModel.isSelected(this._trackByValue(s))}toggleDescendants(s){this.expansionModel.isSelected(this._trackByValue(s))?this.collapseDescendants(s):this.expandDescendants(s)}collapseAll(){this.expansionModel.clear()}expandDescendants(s){let t=[s];t.push(...this.getDescendants(s)),this.expansionModel.select(...t.map(n=>this._trackByValue(n)))}collapseDescendants(s){let t=[s];t.push(...this.getDescendants(s)),this.expansionModel.deselect(...t.map(n=>this._trackByValue(n)))}_trackByValue(s){return this.trackBy?this.trackBy(s):s}}class X extends K{constructor(s,t,n){super(),this.getLevel=s,this.isExpandable=t,this.options=n,this.options&&(this.trackBy=this.options.trackBy)}getDescendants(s){const n=[];for(let i=this.dataNodes.indexOf(s)+1;i<this.dataNodes.length&&this.getLevel(s)<this.getLevel(this.dataNodes[i]);i++)n.push(this.dataNodes[i]);return n}expandAll(){this.expansionModel.select(...this.dataNodes.map(s=>this._trackByValue(s)))}}const C=new e.OlP("CDK_TREE_NODE_OUTLET_NODE");let m=(()=>{class o{constructor(t,n){this.viewContainer=t,this._node=n}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(e.s_b),e.Y36(C,8))};static#t=this.\u0275dir=e.lG2({type:o,selectors:[["","cdkTreeNodeOutlet",""]]})}return o})();class z{constructor(s){this.$implicit=s}}let b=(()=>{class o{constructor(t){this.template=t}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(e.Rgc))};static#t=this.\u0275dir=e.lG2({type:o,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}})}return o})(),h=(()=>{class o{get dataSource(){return this._dataSource}set dataSource(t){this._dataSource!==t&&this._switchDataSource(t)}constructor(t,n){this._differs=t,this._changeDetectorRef=n,this._onDestroy=new y.x,this._levels=new Map,this.viewChange=new v.X({start:0,end:Number.MAX_VALUE})}ngOnInit(){this._dataDiffer=this._differs.find([]).create(this.trackBy)}ngOnDestroy(){this._nodeOutlet.viewContainer.clear(),this.viewChange.complete(),this._onDestroy.next(),this._onDestroy.complete(),this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null)}ngAfterContentChecked(){const t=this._nodeDefs.filter(n=>!n.when);this._defaultNodeDef=t[0],this.dataSource&&this._nodeDefs&&!this._dataSubscription&&this._observeRenderChanges()}_switchDataSource(t){this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),t||this._nodeOutlet.viewContainer.clear(),this._dataSource=t,this._nodeDefs&&this._observeRenderChanges()}_observeRenderChanges(){let t;(0,M.Z9)(this._dataSource)?t=this._dataSource.connect(this):(0,Q.b)(this._dataSource)?t=this._dataSource:Array.isArray(this._dataSource)&&(t=(0,H.of)(this._dataSource)),t&&(this._dataSubscription=t.pipe((0,x.R)(this._onDestroy)).subscribe(n=>this.renderNodeChanges(n)))}renderNodeChanges(t,n=this._dataDiffer,i=this._nodeOutlet.viewContainer,r){const a=n.diff(t);a&&(a.forEachOperation((c,g,N)=>{if(null==c.previousIndex)this.insertNode(t[N],N,i,r);else if(null==N)i.remove(g),this._levels.delete(c.item);else{const we=i.get(g);i.move(we,N)}}),this._changeDetectorRef.detectChanges())}_getNodeDef(t,n){return 1===this._nodeDefs.length?this._nodeDefs.first:this._nodeDefs.find(r=>r.when&&r.when(n,t))||this._defaultNodeDef}insertNode(t,n,i,r){const a=this._getNodeDef(t,n),c=new z(t);c.level=this.treeControl.getLevel?this.treeControl.getLevel(t):typeof r<"u"&&this._levels.has(r)?this._levels.get(r)+1:0,this._levels.set(t,c.level),(i||this._nodeOutlet.viewContainer).createEmbeddedView(a.template,c,n),u.mostRecentTreeNode&&(u.mostRecentTreeNode.data=t)}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(e.ZZ4),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["cdk-tree"]],contentQueries:function(n,i,r){if(1&n&&e.Suo(r,b,5),2&n){let a;e.iGM(a=e.CRH())&&(i._nodeDefs=a)}},viewQuery:function(n,i){if(1&n&&e.Gf(m,7),2&n){let r;e.iGM(r=e.CRH())&&(i._nodeOutlet=r.first)}},hostAttrs:["role","tree",1,"cdk-tree"],inputs:{dataSource:"dataSource",treeControl:"treeControl",trackBy:"trackBy"},exportAs:["cdkTree"],decls:1,vars:0,consts:[["cdkTreeNodeOutlet",""]],template:function(n,i){1&n&&e.GkF(0,0)},dependencies:[m],encapsulation:2})}return o})(),u=(()=>{class o{get role(){return"treeitem"}set role(t){this._elementRef.nativeElement.setAttribute("role",t)}static#e=this.mostRecentTreeNode=null;get data(){return this._data}set data(t){t!==this._data&&(this._data=t,this._setRoleFromData(),this._dataChanges.next())}get isExpanded(){return this._tree.treeControl.isExpanded(this._data)}get level(){return this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._data):this._parentNodeAriaLevel}constructor(t,n){this._elementRef=t,this._tree=n,this._destroyed=new y.x,this._dataChanges=new y.x,o.mostRecentTreeNode=this,this.role="treeitem"}ngOnInit(){this._parentNodeAriaLevel=function W(o){let s=o.parentElement;for(;s&&!ee(s);)s=s.parentElement;return s?s.classList.contains("cdk-nested-tree-node")?(0,p.su)(s.getAttribute("aria-level")):0:-1}(this._elementRef.nativeElement),this._elementRef.nativeElement.setAttribute("aria-level",`${this.level+1}`)}ngOnDestroy(){o.mostRecentTreeNode===this&&(o.mostRecentTreeNode=null),this._dataChanges.complete(),this._destroyed.next(),this._destroyed.complete()}focus(){this._elementRef.nativeElement.focus()}_setRoleFromData(){this.role="treeitem"}static#t=this.\u0275fac=function(n){return new(n||o)(e.Y36(e.SBq),e.Y36(h))};static#n=this.\u0275dir=e.lG2({type:o,selectors:[["cdk-tree-node"]],hostAttrs:[1,"cdk-tree-node"],hostVars:1,hostBindings:function(n,i){2&n&&e.uIk("aria-expanded",i.isExpanded)},inputs:{role:"role"},exportAs:["cdkTreeNode"]})}return o})();function ee(o){const s=o.classList;return!(!s?.contains("cdk-nested-tree-node")&&!s?.contains("cdk-tree"))}const te=/([A-Za-z%]+)$/;let I=(()=>{class o{get level(){return this._level}set level(t){this._setLevelInput(t)}get indent(){return this._indent}set indent(t){this._setIndentInput(t)}constructor(t,n,i,r){this._treeNode=t,this._tree=n,this._element=i,this._dir=r,this._destroyed=new y.x,this.indentUnits="px",this._indent=40,this._setPadding(),r&&r.change.pipe((0,x.R)(this._destroyed)).subscribe(()=>this._setPadding(!0)),t._dataChanges.subscribe(()=>this._setPadding())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_paddingIndent(){const t=this._treeNode.data&&this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._treeNode.data):null,n=null==this._level?t:this._level;return"number"==typeof n?`${n*this._indent}${this.indentUnits}`:null}_setPadding(t=!1){const n=this._paddingIndent();if(n!==this._currentPadding||t){const i=this._element.nativeElement,r=this._dir&&"rtl"===this._dir.value?"paddingRight":"paddingLeft",a="paddingLeft"===r?"paddingRight":"paddingLeft";i.style[r]=n||"",i.style[a]="",this._currentPadding=n}}_setLevelInput(t){this._level=(0,p.su)(t,null),this._setPadding()}_setIndentInput(t){let n=t,i="px";if("string"==typeof t){const r=t.split(te);n=r[0],i=r[1]||i}this.indentUnits=i,this._indent=(0,p.su)(n),this._setPadding()}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(u),e.Y36(h),e.Y36(e.SBq),e.Y36($.Is,8))};static#t=this.\u0275dir=e.lG2({type:o,selectors:[["","cdkTreeNodePadding",""]],inputs:{level:["cdkTreeNodePadding","level"],indent:["cdkTreeNodePaddingIndent","indent"]}})}return o})(),k=(()=>{class o{get recursive(){return this._recursive}set recursive(t){this._recursive=(0,p.Ig)(t)}constructor(t,n){this._tree=t,this._treeNode=n,this._recursive=!1}_toggle(t){this.recursive?this._tree.treeControl.toggleDescendants(this._treeNode.data):this._tree.treeControl.toggle(this._treeNode.data),t.stopPropagation()}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(h),e.Y36(u))};static#t=this.\u0275dir=e.lG2({type:o,selectors:[["","cdkTreeNodeToggle",""]],hostBindings:function(n,i){1&n&&e.NdJ("click",function(a){return i._toggle(a)})},inputs:{recursive:["cdkTreeNodeToggleRecursive","recursive"]}})}return o})(),ne=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({})}return o})();var oe=d(3019),ie=d(8180),se=d(7398);const re=(0,f.sb)((0,f.Id)(u));let R=(()=>{class o extends re{constructor(t,n,i){super(t,n),this.tabIndex=Number(i)||0}ngOnInit(){super.ngOnInit()}ngOnDestroy(){super.ngOnDestroy()}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(e.SBq),e.Y36(h),e.$8M("tabindex"))};static#t=this.\u0275dir=e.lG2({type:o,selectors:[["mat-tree-node"]],hostAttrs:[1,"mat-tree-node"],inputs:{role:"role",disabled:"disabled",tabIndex:"tabIndex"},exportAs:["matTreeNode"],features:[e._Bn([{provide:u,useExisting:o}]),e.qOj]})}return o})(),J=(()=>{class o extends b{static#e=this.\u0275fac=function(){let t;return function(i){return(t||(t=e.n5z(o)))(i||o)}}();static#t=this.\u0275dir=e.lG2({type:o,selectors:[["","matTreeNodeDef",""]],inputs:{when:["matTreeNodeDefWhen","when"],data:["matTreeNode","data"]},features:[e._Bn([{provide:b,useExisting:o}]),e.qOj]})}return o})(),Y=(()=>{class o extends I{get level(){return this._level}set level(t){this._setLevelInput(t)}get indent(){return this._indent}set indent(t){this._setIndentInput(t)}static#e=this.\u0275fac=function(){let t;return function(i){return(t||(t=e.n5z(o)))(i||o)}}();static#t=this.\u0275dir=e.lG2({type:o,selectors:[["","matTreeNodePadding",""]],inputs:{level:["matTreeNodePadding","level"],indent:["matTreeNodePaddingIndent","indent"]},features:[e._Bn([{provide:I,useExisting:o}]),e.qOj]})}return o})(),w=(()=>{class o{constructor(t,n){this.viewContainer=t,this._node=n}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(e.s_b),e.Y36(C,8))};static#t=this.\u0275dir=e.lG2({type:o,selectors:[["","matTreeNodeOutlet",""]],features:[e._Bn([{provide:m,useExisting:o}])]})}return o})(),U=(()=>{class o extends h{constructor(){super(...arguments),this._nodeOutlet=void 0}static#e=this.\u0275fac=function(){let t;return function(i){return(t||(t=e.n5z(o)))(i||o)}}();static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["mat-tree"]],viewQuery:function(n,i){if(1&n&&e.Gf(w,7),2&n){let r;e.iGM(r=e.CRH())&&(i._nodeOutlet=r.first)}},hostAttrs:["role","tree",1,"mat-tree"],exportAs:["matTree"],features:[e._Bn([{provide:h,useExisting:o}]),e.qOj],decls:1,vars:0,consts:[["matTreeNodeOutlet",""]],template:function(n,i){1&n&&e.GkF(0,0)},dependencies:[w],styles:[".mat-tree{display:block}.mat-tree-node{display:flex;align-items:center;flex:1;word-wrap:break-word}.mat-nested-tree-node{border-bottom-width:0}"],encapsulation:2})}return o})(),L=(()=>{class o extends k{static#e=this.\u0275fac=function(){let t;return function(i){return(t||(t=e.n5z(o)))(i||o)}}();static#t=this.\u0275dir=e.lG2({type:o,selectors:[["","matTreeNodeToggle",""]],inputs:{recursive:["matTreeNodeToggleRecursive","recursive"]},features:[e._Bn([{provide:k,useExisting:o}]),e.qOj]})}return o})(),de=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[ne,f.BQ,f.BQ]})}return o})();class ce{constructor(s,t,n,i){this.transformFunction=s,this.getLevel=t,this.isExpandable=n,this.getChildren=i}_flattenNode(s,t,n,i){const r=this.transformFunction(s,t);if(n.push(r),this.isExpandable(r)){const a=this.getChildren(s);a&&(Array.isArray(a)?this._flattenChildren(a,t,n,i):a.pipe((0,ie.q)(1)).subscribe(c=>{this._flattenChildren(c,t,n,i)}))}return n}_flattenChildren(s,t,n,i){s.forEach((r,a)=>{let c=i.slice();c.push(a!=s.length-1),this._flattenNode(r,t+1,n,c)})}flattenNodes(s){let t=[];return s.forEach(n=>this._flattenNode(n,0,t,[])),t}expandFlattenedNodes(s,t){let n=[],i=[];return i[0]=!0,s.forEach(r=>{let a=!0;for(let c=0;c<=this.getLevel(r);c++)a=a&&i[c];a&&n.push(r),this.isExpandable(r)&&(i[this.getLevel(r)+1]=t.isExpanded(r))}),n}}class le extends M.o2{get data(){return this._data.value}set data(s){this._data.next(s),this._flattenedData.next(this._treeFlattener.flattenNodes(this.data)),this._treeControl.dataNodes=this._flattenedData.value}constructor(s,t,n){super(),this._treeControl=s,this._treeFlattener=t,this._flattenedData=new v.X([]),this._expandedData=new v.X([]),this._data=new v.X([]),n&&(this.data=n)}connect(s){return(0,oe.T)(s.viewChange,this._treeControl.expansionModel.changed,this._flattenedData).pipe((0,se.U)(()=>(this._expandedData.next(this._treeFlattener.expandFlattenedNodes(this._flattenedData.value,this._treeControl)),this._expandedData.value)))}disconnect(){}}var ue=d(4475),T=d(1993),ge=d(836),j=d(9397),he=d(6306),P=d(4664),G=d(2596);function fe(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw();return e.KtG(r.addSubCategory(i))}),e._UZ(1,"mat-icon",25),e.qZA()}2&o&&e.Q6J("matTooltipPosition","above")}function pe(o,s){1&o&&(e.TgZ(0,"button",26),e._UZ(1,"mat-icon",27),e.qZA())}function me(o,s){if(1&o&&(e.TgZ(0,"mat-tree-node",21)(1,"div",3),e.YNc(2,fe,2,1,"button",22),e.YNc(3,pe,2,0,"button",23),e.TgZ(4,"span"),e._uU(5),e.qZA()()()),2&o){const t=s.$implicit;e.xp6(2),e.Q6J("ngIf","main"===t.type),e.xp6(1),e.Q6J("ngIf","sub"===t.type),e.xp6(1),e.ekj("font-semibold","main"===t.type),e.xp6(1),e.Oqu(t.name)}}function _e(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"mat-tree-node",28)(1,"button",24),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.addSubCategory(r))}),e._UZ(2,"mat-icon",25),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA()()}if(2&o){const t=s.$implicit;e.xp6(1),e.Q6J("matTooltipPosition","above"),e.xp6(2),e.ekj("font-semibold","main"===t.type),e.xp6(1),e.Oqu(t.name)}}function ye(o,s){1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o&&(e.xp6(1),e.hij(" ","Add Main Category "," "))}function ve(o,s){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.AsE(" ","Create sub category for "," ",t.categoryForm.get("main_category").value," ")}}function xe(o,s){1&o&&(e.ynx(0),e.TgZ(1,"mat-form-field",15)(2,"mat-label"),e._uU(3),e.qZA(),e._UZ(4,"input",29,30),e.qZA(),e.BQk()),2&o&&(e.xp6(3),e.Oqu("Main Category Name"),e.xp6(1),e.Q6J("formControlName","main_category"))}function Ce(o,s){if(1&o&&(e.TgZ(0,"mat-option",31)(1,"span",32),e._uU(2),e.qZA()()),2&o){const t=s.$implicit;e.Q6J("value",t),e.xp6(2),e.Oqu(t)}}function be(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(i){return e.CHM(t),e.oxw(2).removeAvatar(),e.KtG(i.stopPropagation())}),e._UZ(1,"mat-icon",43),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",t.categoryForm.disabled),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:trash")}}function Te(o,s){1&o&&e._UZ(0,"img",44)}function Ne(o,s){if(1&o&&e._UZ(0,"img",45),2&o){const t=e.oxw(2);e.Q6J("src",t.imageSrc,e.LSH)}}function De(o,s){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",33)(2,"p",34),e._uU(3),e.qZA(),e.TgZ(4,"div",35),e.YNc(5,be,2,2,"button",36),e.YNc(6,Te,1,0,"img",37),e.YNc(7,Ne,1,1,"img",38),e.TgZ(8,"div")(9,"input",39,40),e.NdJ("change",function(){e.CHM(t);const i=e.MAs(11),r=e.oxw();return e.KtG(r.uploadAvatar(i.files))}),e.qZA()(),e.TgZ(12,"button",41),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(10);return e.KtG(i.click())}),e._uU(13),e.qZA()()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(3),e.hij(" ","Sub Category Image *"," "),e.xp6(2),e.Q6J("ngIf",t.imageSrc),e.xp6(1),e.Q6J("ngIf",!t.imageSrc),e.xp6(1),e.Q6J("ngIf",t.imageSrc),e.xp6(2),e.Q6J("multiple",!1)("disabled",t.categoryForm.disabled)("accept","image/*"),e.xp6(3),e.Q6J("disabled",t.categoryForm.disabled),e.xp6(1),e.hij(" ","Select Image"," ")}}function Ae(o,s){1&o&&e._UZ(0,"mat-progress-spinner",48),2&o&&e.Q6J("diameter",24)("mode","indeterminate")}function Me(o,s){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",46),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submit())}),e.YNc(2,Ae,1,2,"mat-progress-spinner",47),e._uU(3),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.categoryForm.invalid),e.xp6(1),e.Q6J("ngIf",t.categoryForm.disabled),e.xp6(1),e.hij(" ","Save"," ")}}function Fe(o,s){1&o&&e._UZ(0,"mat-progress-spinner",48),2&o&&e.Q6J("diameter",24)("mode","indeterminate")}function Ie(o,s){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",46),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submit())}),e.YNc(2,Fe,1,2,"mat-progress-spinner",47),e._uU(3),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.categoryForm.invalid||!t.imageSrc),e.xp6(1),e.Q6J("ngIf",t.categoryForm.disabled),e.xp6(1),e.hij(" ","Save"," ")}}const ke=[{path:"",component:(()=>{class o{constructor(){this.imageSrc=null,this.ImageFile=null,this.TREE_DATA=[],this._transformer=(t,n)=>({expandable:!!t.subs&&t.subs.length>0,name:t.category_name,level:n,type:t.category_type,id_main_category:t._id}),this.treeControl=new X(t=>t.level,t=>t.expandable),this.treeFlattener=new ce(this._transformer,t=>t.level,t=>t.expandable,t=>t.subs),this.dataSource=new le(this.treeControl,this.treeFlattener),this.hasChild=(t,n)=>n.expandable,this.statustypes=["active","inActive"],this.mode="add-main",this.categories=[],this.category=null,this.toast=V().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3}),this._formBuilder=(0,e.f3M)(l.QS),this.destroyRef=(0,e.f3M)(e.ktI),this._CategoriesService=(0,e.f3M)(ue.G),this.location=(0,e.f3M)(D.Ye),this.dataSource.data=this.TREE_DATA}ngOnInit(){this._CategoriesService.getTreeCategories().subscribe(t=>{}),this._CategoriesService.categories$.pipe((0,ge.T)(1),(0,T.sL)(this.destroyRef),(0,j.b)(t=>{console.log("loading data !",t),this.categories=t,this.TREE_DATA=t,this.dataSource.data=t,this.treeControl.expandAll()})).subscribe(),this.categoryForm=this._formBuilder.group({category_name:["",[l.kI.required]],status:["active",[l.kI.required]],category_type:["main",[l.kI.required]],image:[]})}submit(){if(this.categoryForm.invalid)return;const t={...this.categoryForm.value};console.log("paylaod: ",t),"add-main"==this.mode?this.add_main_Category(t):"add-subcategory"==this.mode&&this.submit_add_subCategory()}addSubCategory(t){this.categoryForm.contains("main_category")?this.categoryForm.get("main_category").setValue(t.name):this.categoryForm.addControl("main_category",new l.NI(t.name)),this.categoryForm.contains("category_id")?this.categoryForm.get("category_id").setValue(t.id_main_category):this.categoryForm.addControl("category_id",new l.NI(t.id_main_category)),this.categoryForm.get("main_category").disable(),this.categoryForm.get("category_type").setValue("sub"),this.mode="add-subcategory",console.log("node add sub category",t);const n={...this.categoryForm.value};console.log("node add sun category paylaod",n)}addMainCategory(){this.mode="add-main",this.categoryForm=this._formBuilder.group({category_name:["",[l.kI.required]],status:["active",[l.kI.required]],category_type:["main",[l.kI.required]],image:[]})}add_main_Category(t){this.categoryForm.disable(),this._CategoriesService.create_category(t).pipe((0,T.sL)(this.destroyRef),(0,j.b)(n=>{(n.code=200)?(this.toast.fire({icon:"success",title:"Success Add Main Category"}),this.categoryForm.enable(),this.categoryForm.get("category_name").reset()):(this.toast.fire({icon:"error",title:"somthing error"}),this.categoryForm.enable())}),(0,he.K)(n=>(console.log("error",n.error.message),this.toast.fire({icon:"error",title:n.error.message}),this.categoryForm.enable(),n)),(0,P.w)(()=>this._CategoriesService.getTreeCategories())).subscribe()}submit_add_subCategory(){!this.categoryForm.invalid&&this.imageSrc&&(this.categoryForm.disable(),this._CategoriesService.uploadImage(this.ImageFile).pipe((0,T.sL)(this.destroyRef),(0,P.w)(n=>{console.log("Uploading image switched ",n),this.categoryForm.get("image").setValue(n);const i={...this.categoryForm.value};return console.log("paylaod: ",i),delete i.main_category,console.log("paylaod: ",i),this._CategoriesService.create_category(i)})).subscribe({next:n=>{console.log("success add category",n),this.toast.fire({icon:"success",title:"Success Add Sub Category"}),this._CategoriesService.getTreeCategories().pipe((0,T.sL)(this.destroyRef)).subscribe(),this.categoryForm.enable(),this.categoryForm.reset()},error:n=>{console.log("error:",n),this.toast.fire({icon:"error",title:n.error?.message}),this.categoryForm.enable()}}))}buildTreeCategory(t){const n=new Map,i=new Set;t.forEach(a=>{const c=a?.category_id?._id;if(c)console.log("categoryId",c),n.has(c)||(n.set(c,{...a.category_id,subs:[]}),i.add(c)),n.get(c).subs.push(a),i.delete(c);else{const g=a._id;console.log("test category",n.has(g)),console.log("test category",g),n.has(g)||(n.set(g,{...a}),i.add(g))}});const r=Array.from(n.values());return console.log(r),r}removeAvatar(){this.imageSrc=null,this.ImageFile=null}uploadAvatar(t){if(!t.length)return;const i=t[0];if(!["image/jpeg","image/png"].includes(i.type))return;const r=new FileReader;r.readAsDataURL(i),r.onload=()=>{this.imageSrc=r.result},this.ImageFile=i}NavigationBack(){this.location.back()}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-category"]],standalone:!0,features:[e.jDz],decls:39,vars:17,consts:[[1,"relative","inset-0","min-w-0","overflow-y-auto","p-1","w-full"],[1,"flex-auto","pt-9","pb-9","md:px-8","lg:px-12","grid","sm:grid-cols-3","gap-6","w-full"],[1,"sm:col-span-1","px-8","py-12","h-full","bg-card"],[1,"w-full"],["mat-flat-button","",1,"bg-primary","rounded-sm",3,"click"],["svgIcon","heroicons_solid:folder",1,"icon-size-4"],[1,"px-2","font-semibold"],["isExpanded","true",1,"border-l",3,"dataSource","treeControl"],["matTreeNodePadding","",4,"matTreeNodeDef"],["matTreeNodeToggle","","matTreeNodePadding","",4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"sm:col-span-2","bg-card","px-8","py-1","rounded-md"],[1,"w-full","mt-8","mb-4","pb-4",3,"formGroup"],[1,"text-xl","md:text-3xl","font-bold","tracking-tight","leading-7","sm:leading-10","truncate"],[4,"ngIf"],[1,"flex","flex-col","justify-center"],[1,"fuse-mat-no-subscript","w-full"],["matInput","","placeholder","Product category_name",3,"formControlName"],[3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","justify-center","sm:justify-end","px-2","pt-4","space-x-3","border-t"],["mat-stroked-button","",3,"click"],["matTreeNodePadding",""],["mat-icon-button","","matTooltip","add sub category",3,"matTooltipPosition","click",4,"ngIf"],["mat-icon-button","",4,"ngIf"],["mat-icon-button","","matTooltip","add sub category",3,"matTooltipPosition","click"],["svgIcon","mat_solid:create_new_folder",1,"icon-size-4"],["mat-icon-button",""],["svgIcon","heroicons_outline:folder-minus",1,"icon-size-4"],["matTreeNodeToggle","","matTreeNodePadding",""],["matInput","","readonly","",3,"formControlName"],["main_category_name",""],[3,"value"],[1,"ml-3"],[1,"w-full","flex","flex-row","justify-between","items-start","border-2","rounded-md","p-4","my-2"],[1,"text-base","font-normal","my-2","text-default"],[1,"bg-default","flex","flex-col","justify-center","items-center","px-8","py-8"],["mat-icon-button","","class","flex items-center justify-center w-10 h-10 rounded-full cursor-pointer hover:bg-hover","matRipple","",3,"disabled","click",4,"ngIf"],["src","assets/images/image-upload.svg","alt","img","srcset","","class","block min-w-70 min-h-50 max-w-70 max-h-50 object-fill",4,"ngIf"],["alt","img","srcset","","class","block min-w-70 min-h-50 max-w-70 max-h-50 object-fill",3,"src",4,"ngIf"],["id","avatar-file-input","type","file",1,"absolute","h-0","w-0","opacity-0","invisible","pointer-events-none",3,"multiple","disabled","accept","change"],["img_banner","","avatarFileInput",""],["mat-flat-button","",1,"block","bg-[#FFF9C4]","text-black","my-3","px-4","py-2",3,"disabled","click"],["mat-icon-button","","matRipple","",1,"flex","items-center","justify-center","w-10","h-10","rounded-full","cursor-pointer","hover:bg-hover",3,"disabled","click"],[1,"text-red-500",3,"svgIcon"],["src","assets/images/image-upload.svg","alt","img","srcset","",1,"block","min-w-70","min-h-50","max-w-70","max-h-50","object-fill"],["alt","img","srcset","",1,"block","min-w-70","min-h-50","max-w-70","max-h-50","object-fill",3,"src"],["mat-flat-button","","color","primary",1,"px-8",3,"disabled","click"],[3,"diameter","mode",4,"ngIf"],[3,"diameter","mode"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),e.NdJ("click",function(){return i.addMainCategory()}),e._UZ(5,"mat-icon",5),e.TgZ(6,"span",6),e._uU(7),e.qZA()()(),e.TgZ(8,"mat-tree",7),e.YNc(9,me,6,5,"mat-tree-node",8),e.YNc(10,_e,5,4,"mat-tree-node",9),e.qZA()(),e.TgZ(11,"div",10)(12,"div",3)(13,"form",11)(14,"div")(15,"h2",12),e.YNc(16,ye,2,1,"ng-container",13),e.YNc(17,ve,2,2,"ng-container",13),e.qZA()(),e.TgZ(18,"div",14),e.YNc(19,xe,6,2,"ng-container",13),e.TgZ(20,"mat-form-field",15)(21,"mat-label"),e._uU(22),e.qZA(),e._UZ(23,"input",16),e.qZA(),e.TgZ(24,"mat-form-field",3)(25,"mat-label"),e._uU(26),e.qZA(),e.TgZ(27,"mat-select",17),e.YNc(28,Ce,3,2,"mat-option",18),e.qZA(),e.TgZ(29,"mat-hint"),e._uU(30,"Active the category"),e.qZA()(),e.YNc(31,De,14,9,"ng-container",13),e.qZA()(),e.ynx(32),e.TgZ(33,"div",19),e.ynx(34),e.TgZ(35,"button",20),e.NdJ("click",function(){return i.categoryForm.reset(),i.NavigationBack()}),e._uU(36),e.qZA(),e.BQk(),e.YNc(37,Me,4,3,"ng-container",13),e.YNc(38,Ie,4,3,"ng-container",13),e.qZA(),e.BQk(),e.qZA()()()()),2&n&&(e.xp6(7),e.hij(" ","Add Main Category"," "),e.xp6(1),e.Q6J("dataSource",i.dataSource)("treeControl",i.treeControl),e.xp6(2),e.Q6J("matTreeNodeDefWhen",i.hasChild),e.xp6(3),e.Q6J("formGroup",i.categoryForm),e.xp6(3),e.Q6J("ngIf","add-main"==i.mode),e.xp6(1),e.Q6J("ngIf","add-subcategory"==i.mode),e.xp6(2),e.Q6J("ngIf","add-subcategory"==i.mode),e.xp6(3),e.Oqu("Category Name"),e.xp6(1),e.Q6J("formControlName","category_name"),e.xp6(3),e.Oqu("Status"),e.xp6(1),e.Q6J("formControlName","status"),e.xp6(1),e.Q6J("ngForOf",i.statustypes),e.xp6(3),e.Q6J("ngIf","add-subcategory"==i.mode),e.xp6(5),e.hij(" ","cance"," "),e.xp6(1),e.Q6J("ngIf","add-main"===i.mode),e.xp6(1),e.Q6J("ngIf","add-subcategory"===i.mode))},dependencies:[D.O5,D.ax,O.Ps,O.Hw,A.ot,A.lW,A.RK,_.lN,_.KE,_.hX,_.bx,l.UX,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,B.c,B.Nt,f.si,f.wG,G.AV,G.gM,Z.LD,Z.gD,f.ey,f.Ng,de,J,Y,L,U,R,S.Cq,S.Ou]})}return o})()}]}}]);